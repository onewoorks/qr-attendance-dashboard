<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <link rel="apple-touch-icon" sizes="76x76" href="./assets/img/apple-icon.png">
  <link rel="icon" type="image/png" href="./assets/img/favicon.png">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <title>
    Attendance Dashboard
  </title>
  <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no'
    name='viewport' />
  <!--     Fonts and icons     -->
  <link rel="stylesheet" type="text/css"
    href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:400,700|Material+Icons" />
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css">
  <!-- CSS Files -->
  <link href="./assets/css/material-dashboard.css?v=2.1.1" rel="stylesheet" />
  <link rel="stylesheet" href="./assets/css/overwrite.css" />
</head>

<body class="">
  <div class="wrapper ">
    <div class="main-panel">
      <div class="content">
        <div class="container-fluid">
          <div class="d-flex flex-wrap">
            <div class="w-20">
              <div class="card card-stats">
                <div class="card-header card-header-warning card-header-icon">
                  <div class="card-icon">
                    <span class='zone-letter'>A</span>
                  </div>
                  <p class="card-category">VIP Sitting Zone</p>
                  <h3 class="card-title">
                    <span id="zone_a_present"></span>/<span id="zone_a_total"></span>
                  </h3>
                </div>
                <div class="card-footer">
                  <div class="stats">
                    <a href="./sitting-zone.html?zone=a" target="_blank">View Attendance</a>
                  </div>
                </div>
              </div>
            </div>
            <div class="w-20">
              <div class="card card-stats">
                <div class="card-header card-header-success card-header-icon">
                  <div class="card-icon">
                    <span class='zone-letter'>B</span>
                  </div>
                  <p class="card-category">Sitting Zone</p>
                  <h3 class="card-title"><span id="zone_b_present"></span>/<span id="zone_b_total"></span></h3>
                </div>
                <div class="card-footer">
                  <div class="stats">
                      <a href="./sitting-zone.html?zone=b" target="_blank">View Attendance</a>
                  </div>
                </div>
              </div>
            </div>
            <div class="w-20">
              <div class="card card-stats">
                <div class="card-header card-header-danger card-header-icon">
                  <div class="card-icon">
                    <span class='zone-letter'>C</span>
                  </div>
                  <p class="card-category">Sitting Zone</p>
                  <h3 class="card-title">
                    <span id="zone_c_present"></span>/<span id="zone_c_total"></span>
                  </h3>
                </div>
                <div class="card-footer">
                  <div class="stats">
                    <a href="./sitting-zone.html?zone=c" target="_blank">View Attendance</a>
                  </div>
                </div>
              </div>
            </div>
            <div class="w-20">
              <div class="card card-stats">
                <div class="card-header card-header-info card-header-icon">
                  <div class="card-icon">
                    <span class='zone-letter'>D</span>
                  </div>
                  <p class="card-category">Sitting Zone</p>
                  <h3 class="card-title"><span id="zone_d_present"></span>/<span id="zone_d_total"></span></h3>
                </div>
                <div class="card-footer">
                  <div class="stats">
                      <a href="./sitting-zone.html?zone=d" target="_blank">View Attendance</a>
                  </div>
                </div>
              </div>
            </div>
            <div class="w-20">
              <div class="card card-stats">
                <div class="card-header card-header-primary card-header-icon">
                  <div class="card-icon">
                    <span class='zone-letter'>E</span>
                  </div>
                  <p class="card-category">Sitting Zone</p>
                  <h3 class="card-title"><span id="zone_e_present"></span>/<span id="zone_e_total"></span></h3>
                </div>
                <div class="card-footer">
                  <div class="stats">
                      <a href="./sitting-zone.html?zone=e" target="_blank">View Attendance</a>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="row d-none">
            <div class="col-1-5 col-sm-6">
              <div class="card card-stats">
                <div class="card-header card-header-warning card-header-icon">
                  <div class="card-icon">
                    <span class='zone-letter'>A</span>
                  </div>
                  <p class="card-category">Sitting Zone</p>
                  <h3 class="card-title"><span id="zone_a_present"></span>/<span id="zone_a_total"></span> </h3>
                </div>
                <div class="card-footer">
                  <div class="stats">
                    <a href="#pablo">View attendance</a>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-1-5 col-sm-6">
              <div class="card card-stats">
                <div class="card-header card-header-success card-header-icon">
                  <div class="card-icon">
                    <span class='zone-letter'>B</span>
                  </div>
                  <p class="card-category">Sitting Zone</p>
                  <h3 class="card-title"><span id="zone_b_present"></span>/<span id="zone_b_total"></span></h3>
                </div>
                <div class="card-footer">
                  <div class="stats">
                    View Attendance
                  </div>
                </div>
              </div>
            </div>
            <div class="col-1-5 col-sm-6">
              <div class="card card-stats">
                <div class="card-header card-header-danger card-header-icon">
                  <div class="card-icon">
                    <span class='zone-letter'>C</span>
                  </div>
                  <p class="card-category">Sitting Zone</p>
                  <h3 class="card-title"><span id="zone_c_present"></span>/<span id="zone_c_total"></span></h3>
                </div>
                <div class="card-footer">
                  <div class="stats">
                    <a href="#">View Attendance</a>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-1-5 col-sm-6">
              <div class="card card-stats">
                <div class="card-header card-header-info card-header-icon">
                  <div class="card-icon">
                    <span class='zone-letter'>D</span>
                  </div>
                  <p class="card-category">Sitting Zone</p>
                  <h3 class="card-title"><span id="zone_d_present"></span>/<span id="zone_d_total"></span></h3>
                </div>
                <div class="card-footer">
                  <div class="stats">
                    <a href="#">View Attendance</a>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col-lg-6 col-md-12">
              <div class="card">
                <div class="card-header card-header-tabs card-header-primary">
                  <div class="card-title">Latest Attendee</div>
                </div>
                <div class="card-body">
                  <div class="tab-content">
                    <div class="tab-pane active" id="profile">
                      <table id='latest_attendance' class="table" aria-describedby="latest attendance">
                        <thead>
                          <tr>
                            <th scope="col">Timestamp</th>
                            <th scope="col" class='text-left'>Participant Name</th>
                            <th scope="col" class='text-center'>Register Counter</th>
                            <th scope="col" class='text-center'>Sitting Zone</th>
                          </tr>
                        </thead>
                        <tbody>

                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-lg-6 col-md-12">
              <div class="row">
                <div class="col-md-6">
                  <div class="card card-chart">
                    <div class="card-header card-header-success">
                      <div class="ct-chart" id="dailySalesChart"></div>
                    </div>
                    <div class="card-body">
                      <h4 class="card-title">Attendance Pattern</h4>
                      <p class="card-category">
                        <span class="text-success">Time blocked</span></p>
                    </div>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="card card-chart">
                    <div class="card-header card-header-warning">
                      <div class="ct-chart" id="websiteViewsChart"></div>
                    </div>
                    <div class="card-body">
                      <h4 class="card-title">Reader Counter</h4>
                      <p class="card-category">Reader Counter Peformance</p>
                    </div>
                  </div>
                </div>
              </div>


              <div class="card">
                <div class="card-header card-header-warning">
                  <h4 class="card-title">Attendance Event Target</h4>
                </div>
                <div class="card-body table-responsive">
                  <table class="table table-hover" aria-describedby="Attendance Objective">
                    <thead class="text-warning">
                      <th scope="col">Target</th>
                      <th scope="col">Status</th>
                      <th scope="col" class='text-center'>Action</th>
                    </thead>
                    <tbody>
                      <tr>
                        <td>First 1-50</td>
                        <td>Not Complete</td>
                        <td class='text-center'>View</td>
                      </tr>
                      <tr>
                        <td>51 - 100</td>
                        <td>Not Complete</td>
                        <td class='text-center'>View</td>
                      </tr>
                      <tr>
                        <td>101 - 200</td>
                        <td>Not Complete</td>
                        <td class='text-center'>View</td>
                      </tr>
                      <tr>
                        <td>201 - 500</td>
                        <td>Not Complete</td>
                        <td class='text-center'>View</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>


            </div>
          </div>
        </div>
      </div>
      <footer class="footer d-none">
        <div class="container-fluid">
          <nav class="float-left">
            <ul>
              <li>
                <a href="https://onewoorks-solutions.com">
                  Onewoorks Solutions
                </a>
              </li>
              <li>
                <a href="https://onewoorks-solutions.com/presentation">
                  About Us
                </a>
              </li>
              <li>
                <a href="http://blog.onewoorks-solutions.com">
                  Blog
                </a>
              </li>
              <li>
                <a href="https://onewoorks-solutions.com/license">
                  Licenses
                </a>
              </li>
            </ul>
          </nav>
          <div class="copyright float-right">
            &copy;
            <script>
              document.write(new Date().getFullYear())
            </script>, made with <i class="material-icons">favorite</i> by
            <a rel="noopener noreferrer" href="https://onewoorks-solutions.com" target="_blank">Onewoorks Solutions</a>
            for a better web.
          </div>
        </div>
      </footer>
    </div>
  </div>
  <!--   Core JS Files   -->
  <script src="./assets/js/core/jquery.min.js"></script>
  <script src="./assets/js/core/popper.min.js"></script>
  <script src="./assets/js/core/bootstrap-material-design.min.js"></script>
  <script src="./assets/js/plugins/perfect-scrollbar.jquery.min.js"></script>
  <!-- Plugin for the momentJs  -->
  <script src="./assets/js/plugins/moment.min.js"></script>
  <!--  Plugin for Sweet Alert -->
  <script src="./assets/js/plugins/sweetalert2.js"></script>
  <!-- Forms Validations Plugin -->
  <script src="./assets/js/plugins/jquery.validate.min.js"></script>
  <!-- Plugin for the Wizard, full documentation here: https://github.com/VinceG/twitter-bootstrap-wizard -->
  <script src="./assets/js/plugins/jquery.bootstrap-wizard.js"></script>
  <!--	Plugin for Select, full documentation here: http://silviomoreto.github.io/bootstrap-select -->
  <script src="./assets/js/plugins/bootstrap-selectpicker.js"></script>
  <!--  Plugin for the DateTimePicker, full documentation here: https://eonasdan.github.io/bootstrap-datetimepicker/ -->
  <script src="./assets/js/plugins/bootstrap-datetimepicker.min.js"></script>
  <!--  DataTables.net Plugin, full documentation here: https://datatables.net/  -->
  <script src="./assets/js/plugins/jquery.dataTables.min.js"></script>
  <!--	Plugin for Tags, full documentation here: https://github.com/bootstrap-tagsinput/bootstrap-tagsinputs  -->
  <script src="./assets/js/plugins/bootstrap-tagsinput.js"></script>
  <!-- Plugin for Fileupload, full documentation here: http://www.jasny.net/bootstrap/javascript/#fileinput -->
  <script src="./assets/js/plugins/jasny-bootstrap.min.js"></script>
  <!--  Full Calendar Plugin, full documentation here: https://github.com/fullcalendar/fullcalendar    -->
  <script src="./assets/js/plugins/fullcalendar.min.js"></script>
  <!--  Plugin for the Sliders, full documentation here: http://refreshless.com/nouislider/ -->
  <script src="./assets/js/plugins/nouislider.min.js"></script>
  <!-- Include a polyfill for ES6 Promises (optional) for IE11, UC Browser and Android browser support SweetAlert -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/core-js/2.4.1/core.js"></script>
  <!-- Library for adding dinamically elements -->
  <script src="./assets/js/plugins/arrive.min.js"></script>
  <!-- Chartist JS -->
  <script src="./assets/js/plugins/chartist.min.js"></script>
  <!--  Notifications Plugin    -->
  <script src="./assets/js/plugins/bootstrap-notify.js"></script>
  <!-- Control Center for Material Dashboard: parallax effects, scripts for the example pages etc -->
  <script src="./assets/js/material-dashboard.js?v=2.1.1" type="text/javascript"></script>

  <script>
    var sitting_zone = []
    $(document).ready(function () {
      // Javascript method's body can be found in assets/js/demos.js
      md.initDashboardPageCharts();
    });
  </script>
  <script>
    function badge_color(zone) {
      var color = 'default'
      switch (zone) {
        case 'A':
          color = 'warning'
          break;
        case 'B':
          color = 'success'
          break;
        case 'C':
          color = 'danger'
          break
        case 'D':
          color = 'info'
          break
        case 'E': 
          color = 'primary'
          break
      }
      return "badge badge-" + color
    }

    function attendance_list(data) {
      var latest_attendance = $("#latest_attendance>tbody");
      var total_attendance = $("#latest_attendance>tbody tr").length
      var html = "<tr>"
      html += "<td style='width:180px;'>" + data.attend_time + "</td>"
      html += "<td class='text-left'>" + data.customer_name + "</td>"
      html += "<td class='text-center'>" + data.reader_counter + "</td>"
      html += "<td class='text-center'><div class='" + badge_color(data.sitting_zone.toUpperCase()) + "'>" + data.sitting_zone.toUpperCase() + "</div></td>"
      html += "</tr>"
      if (total_attendance > 9) {
        $('#latest_attendance>tbody tr:last').fadeOut("normal", function () {
          $(this).remove()
          latest_attendance.prepend(html)
        })
      } else {
        latest_attendance.prepend(html).fadeIn()
      }
    }

    function sitting_zone(data) {
      $.each(data, function (k, v) {
        $('#zone_' + k.toLowerCase() + "_present").text(v.attend)
        $('#zone_' + k.toLowerCase() + "_total").text(v.total)
      })
    }

    var eventSource = new EventSource("https://nsummit2-qrattendance.onewoorks-solutions.com/dashboard/stream-stat")
    eventSource.onmessage = function (e) {
      var data_obj = JSON.parse(e.data)
      sitting_zone(data_obj.zone)
      $.each(data_obj.attendance, function(k, v){
        attendance_list(v)
      })
    };

  </script>
</body>

</html>